<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
	<!-- Required meta tags -->
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<!-- Bootstrap CSS -->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
		integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" rel="stylesheet"
		integrity="sha384-+0n0xVW2eSR5OomGNYDnhzAbDsOXxcvSN1TPprVMTNDbiYZCxYbOOl7+AMvyTG2x" crossorigin="anonymous">
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.8/css/all.css">

	<!-- RazorPay Script -->
	<script src="https://checkout.razorpay.com/v1/checkout.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
	<!-- favicon -->
	<link rel="shortcut icon" type="image/png" th:href="@{/images/favicon.png}" />

	<title>Home</title>
	<style>
		body,
		* {
			margin: 0px;
			padding: 0px;
		}

		/* navbar css and media query */
		.navbar-brand {
			position: absolute;
		}

		.profilebtn {
			position: absolute;
			right: 3rem;
		}

		@media screen and (max-width: 990px) {
			.navbar-brand {
				position: static;
			}

			.profilebtn {
				position: static;
			}
		}

		/* carousel css and media query */

		carousel-item img {
			height: 650px;
		}

		@media screen and (max-width: 990px) {
			carousel-item img {
				height: 400px;
			}
		}

		/* contact form */
		#Contact {
			background-color: #5B84B1FF;
		}

		.red-star {
			color: rgb(253 23 23 / 83%)
		}
	</style>
</head>

<body>

	<nav class="navbar sticky-top navbar-expand-lg navbar-dark" style="background-color: #00203FFF">
		<div class="container-fluid">
			<a class=" mx-5 navbar-brand" href="#">Techno-Hub</a>
			<button class="navbar-toggler" type="button" data-bs-toggle="collapse"
				data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
				aria-label="Toggle navigation">
				<span class="navbar-toggler-icon"></span>
			</button>
			<div class="collapse navbar-collapse" id="navbarSupportedContent">
				<ul class="navbar-nav d-flex align-items-center justify-content-center fs-5" style="width: 100%;">
					<li class="nav-item">
						<a class="nav-link active" aria-current="page" href="#carouselExampleControls">Home</a>
					</li>
					<li class="nav-item">
						<a class="nav-link" href="#Contact">Counseling</a>
					</li>
				</ul>
			</div>
		</div>
	</nav>

	<div id="carouselExampleControls" class="carousel slide" data-bs-ride="carousel">
		<div class="carousel-inner">
			<div class="carousel-item active">
				<img th:src="@{/images/slide1.jpg}" class="d-block w-100" alt="...">
			</div>
			<div class="carousel-item">
				<img th:src="@{/images/slide2.jpg}" class=".carousel-img d-block w-100" alt="...">
			</div>
			<div class="carousel-item">
				<img th:src="@{/images/slide3.jpg}" class=".carousel-img d-block w-100" alt="...">
			</div>
		</div>
		<button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleControls"
			data-bs-slide="prev">
			<span class="carousel-control-prev-icon" aria-hidden="true"></span>
			<span class="visually-hidden">Previous</span>
		</button>
		<button class="carousel-control-next" type="button" data-bs-target="#carouselExampleControls"
			data-bs-slide="next">
			<span class="carousel-control-next-icon" aria-hidden="true"></span>
			<span class="visually-hidden">Next</span>
		</button>
	</div>

	<div id="Contact" class="py-3">
		<div class="container">
			<h1 class="mb-3">Counseling Form</h1>
			<form class="row g-2 text-white" id="form" action="/save-request" method="POST">
				<div class="col-md-6">
					<label for="FirstName" class="form-label">First name<span class="red-star">*</span></label>
					<input type="text" class="form-control" id="FirstName" name="FirstName" required>
					<div class="invalid-feedback">
						Please provide a valid First Name.
					</div>
					<div class="valid-feedback">
						Looks good!
					</div>
				</div>
				<div class="col-md-6">
					<label for="LastName" class="form-label">Last name<span class="red-star">*</span></label>
					<input type="text" class="form-control" id="LastName" name="LastName" required>
					<div class="invalid-feedback">
						Please provide a valid Last Name.
					</div>
					<div class="valid-feedback">
						Looks good!
					</div>
				</div>
				<div class="col-md-6">
					<label for="Email" class="form-label">E-Mail<span class="red-star">*</span></label>
					<div class="input-group has-validation">
						<input type="Email" class="form-control" id="Email" name="Email" required>
						<div class="invalid-feedback">
							Please provide a valid Email.
						</div>
						<div class="valid-feedback">
							Looks good!
						</div>
					</div>
				</div>
				<div class="col-md-4">
					<label for="City" class="form-label">City<span class="red-star">*</span></label>
					<input type="text" class="form-control" id="City" name="City" required>
					<div class="invalid-feedback">
						Please provide a valid city.
					</div>
					<div class="valid-feedback">
						Looks good!
					</div>
				</div>
				<div class="col-md-4">
					<label for="State" class="form-label">State<span class="red-star">*</span></label>
					<input type="text" class="form-control" id="State" name="State" required>
					<div class="invalid-feedback">
						Please provide a valid city.
					</div>
					<div class="valid-feedback">
						Looks good!
					</div>
				</div>
				<div class="col-md-4">
					<label for="PhoneNumber" class="form-label">Phone Number<span class="red-star">*</span></label>
					<input type="text" class="form-control" id="PhoneNumber" name="PhoneNumber" required>
					<div class="invalid-feedback">
						Please provide a valid Phone number.
					</div>
					<div class="valid-feedback">
						Looks good!
					</div>
				</div>
				<div class="form-group shadow-textarea">
					<label for="Description">Description</label>
					<textarea class="form-control z-depth-1" id="Description" name="Description" rows="3"
						placeholder="Tell us more about the field in which you need Counseling"></textarea>
				</div>
				<div class="col-12 my-4">
					<button type="button" class="btn btn-primary col-12" onclick="isValid()">Pay &#8377; 500</button>
				</div>
			</form>
		</div>
	</div>

	<!-- footer -->

	<footer class="page-footer font-small blue" style="background-color: #00203f;">

		<!-- Copyright -->
		<div class="footer-copyright text-center py-3 text-white">Â© 2021 Copyright:
			<a href="https://techno-hub.org/" style="text-decoration: none;"> Techno-Hub</a>
		</div>
		<!-- Copyright -->

	</footer>
	<!-- Footer -->

	<script>
		$("#FirstName").change(function () {
			const reg = /^[a-zA-Z\s]+$/;
			if (reg.test($("#FirstName").val())) {
				$("#FirstName").addClass("is-valid");
				$("#FirstName").removeClass("is-invalid");
			} else {
				$("#FirstName").addClass("is-invalid");
				$("#FirstName").removeClass("is-valid");
			}
		});
		$("#LastName").change(function () {
			const reg = /^[a-zA-Z\s]+$/;
			if (reg.test($("#LastName").val())) {
				$("#LastName").addClass("is-valid");
				$("#LastName").removeClass("is-invalid");
			} else {
				$("#LastName").addClass("is-invalid");
				$("#LastName").removeClass("is-valid");
			}
		});
		$("#Email").change(function () {
			const reg = /^([a-zA-Z0-9]+)@([a-zA-Z]+)\.([a-zA-Z]+)$/;
			//console.log($("#Email").val());
			if (reg.test($("#Email").val())) {
				$("#Email").addClass("is-valid");
				$("#Email").removeClass("is-invalid");
			} else {
				$("#Email").addClass("is-invalid");
				$("#Email").removeClass("is-valid");
			}
		});
		$("#City").change(() => {
			const reg = /^[a-zA-Z\s]+$/;
			//console.log($("#Email").val());
			if (reg.test($("#City").val())) {
				$("#City").addClass("is-valid");
				$("#City").removeClass("is-invalid");
			} else {
				$("#City").addClass("is-invalid");
				$("#City").removeClass("is-valid");
			}
		})
		$("#State").change(() => {
			const reg = /^[a-zA-Z\s]+$/;
			//console.log($("#State").val());
			if (reg.test($("#State").val())) {
				$("#State").addClass("is-valid");
				$("#State").removeClass("is-invalid");
			} else {
				$("#State").addClass("is-invalid");
				$("#State").removeClass("is-valid");
			}
		});
		$("#PhoneNumber").change(() => {
			const reg = /^[0-9]{10}/;
			//console.log($("#PhoneNumber").val());
			if (reg.test($("#PhoneNumber").val())) {
				$("#PhoneNumber").addClass("is-valid");
				$("#PhoneNumber").removeClass("is-invalid");
			} else {
				$("#PhoneNumber").addClass("is-invalid");
				$("#PhoneNumber").removeClass("is-valid");
			}
		})

		function isValid() {
			var required = $('input').filter('[required]');

			var allRequired = true;

			required.each(function () {
				if ($(this).val() == '') {
					allRequired = false;
				}
			});

			if (!allRequired) {
				swal("Attention!", "Please, fill the form first", "warning");
				return;
			}

			startPayment();
		}

		const startPayment = () => {
			//console.log("paymentStarted")

			$.ajax(
				{
					url: "/create-order",
					data: JSON.stringify({amount: 50000}),
					contentType: 'application/json',
					type: 'POST',
					dataType: 'json',
					success: function (response) {
						if (response.status == "created") {
							let options = {
								"key": "rzp_test_fS3k81U9Notfcz",
								"amount": "50000",
								"currency": "INR",
								"name": "Techno-Hub Pvt. Limited",
								"description": "Counseling Fee",
								"image": "https://techno-hub.org/wp-content/uploads/2021/05/cropped-technohub-1.png",
								"order_id": response.id,
								"handler": function (response) {
									swal("Good job!", "Payment successful", "success");
									$("#form").submit();
								},
								"prefill": {
									"name": "",
									"email": "",
									"contact": ""
								},
								"notes": {
									"address": "Techno-Hub Corporate Office"
								},
								"theme": {
									"color": "#3399cc"
								}
							}//end of options
							var rzp = new Razorpay(options);
							rzp.on('payment.failed', function (response) {
								swal("Failed!", "Payment failed", "error");
							});
							rzp.open();
						}//end of if
					},//end of success function
					error: function (error) {
						swal("Error!", "Server Error", "error");
					}
				}//end of ajax
			)
		}//end of start payment
	</script>

	<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"
		integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p"
		crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"
		integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF"
		crossorigin="anonymous"></script>

</body>

</html>